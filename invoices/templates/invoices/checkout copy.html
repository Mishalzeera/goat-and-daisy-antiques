{% extends 'base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% load crispy_forms_field %}

{% block extra_css %}
<link rel="stylesheet" href="{% static '/css/checkout.css'%}" />
{% endblock %}

{% block content%}



    <form action="{% url 'checkout' %}" method=POST id="payment-form">
        {% csrf_token %}
        {{ form | crispy }}
        <p>Order Amount: {{ order_amount }}</p>
        <p>Shipping: {{ shipping }}</p>
        <p>Total: {{ order_total }} </p>
        <div id="payment-element">
          <!--Stripe.js injects the Payment Element-->
        </div>
        <div id="payment-message" class="hidden"></div>
        <button id="submit">
          <div class="spinner hidden" id="spinner"></div>
          <span id="button-text">Pay now</span>
        </button>
      </form>


{% endblock %}

{% block extra_js %}
{{ block.super }}

{{ stripe_public_key|json_script:'id_stripe_public_key'}}
{{ client_secret|json_script:'id_client_secret'}}

<script src="{% static 'js/checkout.js' %}"></script>

{% endblock %}