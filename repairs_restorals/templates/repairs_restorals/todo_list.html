{% extends 'base.html' %}
{% load crispy_forms_tags %}

{% block content %}

<h1>Todo list</h1>
<form action="." method="POST">
    {% csrf_token %}
    {{ todo_list_form | crispy }}
    <input type="submit" value="Create A New List">
</form>





{% for list in todo_list %}

<div class="task" style="padding-top: 1rem;">

    <div class="list-flex" style="display: flex; align-items: center; gap:2rem;">
        <p class="display-5">{{list.subject}}</p>
        <form action="{% url 'manage_item' pk=list.id %}" method="GET">
            {% csrf_token %}
            <input type="submit" name="delete_list" value="Delete List" style="font-size: 1rem; padding: 0;" class="text-danger">
        </form>

    </div>

    <ul>
        {% for item in list.items.all %}

            <div class="list-item-flex" style="display:flex; gap: 2rem;">
                {% if item.is_completed %}
                <li><s>{{ item.title }}</s></li>
                {% else %}
                <li>{{ item.title }}</li>
                {% endif %}
                <form action="{% url 'manage_item' pk=item.id %}" method="GET">
                    {% csrf_token %}
                    <input type="submit" name="delete_list_item" value="Del" style="font-size: .5rem; padding: 0;" class="text-danger"> 
                </form>
                <form action="{% url 'manage_item' pk=item.id %}" method="GET">
                    {% csrf_token %}
                    {% if item.is_completed %}
                    <input type="submit" name="toggle_item" value="Mark As Incomplete" style="font-size: .8rem; padding: 0;" class="text-alert">
                    {% else %}
                    <input type="submit" name="toggle_item" value="Mark As Complete" style="font-size: .8rem; padding: 0;" class="text-success">
                    {% endif %}
                </form>
            </div>
        {%endfor %}
    </ul>


    <form action="." method=POST>
        {% csrf_token %}
        <input type="hidden" name="todo_list_item" value="{{ list.id }}">
        <input type="text" name="title" id="title">
        <input type="submit" value="Add A Task To This List">
    </form>

    

    


</div>

{% endfor %}

{% endblock %}